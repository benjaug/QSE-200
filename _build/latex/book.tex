%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{QSE 200 Sections}
\date{Oct 11, 2022}
\release{}
\author{Ben Augenbraun}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{home::doc}}


\sphinxAtStartPar
I am collecting notes/notebooks used in the QSE 200 (Fall 2022) Sections on this webpage.
\begin{itemize}
\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{Section4_v2::doc}]{\sphinxcrossref{Section 4: Discrete Variable Representation}}}

\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{Section6_v2::doc}]{\sphinxcrossref{Section 6: An Intuitive Picture of Band Structure}}}

\end{itemize}


\chapter{Section 4: Discrete Variable Representation}
\label{\detokenize{Section4_v2:section-4-discrete-variable-representation}}\label{\detokenize{Section4_v2::doc}}
\sphinxAtStartPar
Last week, we studied the connection between position and momentum space using Fourier transforms. We learned that we can work in either “position space” with basis states \(\langle x' | x \rangle = \delta(x-x')\), or in “momentum space” with basis states \(\langle k' | k \rangle = \delta(k-k')\). We also showed that these kets are connected by the relation
\label{equation:Section4_v2:781d4ce0-a6c5-4224-a0e6-7c9f70db8d33}\begin{equation}
\langle k | x \rangle = (2\pi)^{-1/2} e^{-i k x}.
\end{equation}
\sphinxAtStartPar
In this week’s section, we will use what we learned to build and solve matrix representations of the Hamiltonian for arbitrary 1D potentials using a method called the “Discerete Variable Representation” (DVR). This is a method that is widely used in physics and chemistry to solve for the states and energies of potential energy surfaces needed to describe molecular vibrations, chemical reactions, and beyond.

\sphinxAtStartPar
\sphinxstylestrong{Learning Goals:}
After this Section you should be able to:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Understand when it is more natural to work in a “position” vs. “momentum” basis

\item {} 
\sphinxAtStartPar
Use the sinc basis to express the Hamiltonian for an arbitrary 1D potential

\item {} 
\sphinxAtStartPar
Find the eigenvalues and eigenvectors of Hamiltonians for arbtirary potentials using the discrete variable representation

\end{itemize}


\section{Motivating the Sinc\sphinxhyphen{}Basis DVR}
\label{\detokenize{Section4_v2:motivating-the-sinc-basis-dvr}}
\sphinxAtStartPar
As with previous problems, we’ll first introduce a grid of \(N\) equally spaced points on the domain \([x_\text{min}, x_\text{max}]\). The points can be specified as
\label{equation:Section4_v2:79306469-150e-4e09-a1be-5f214872759a}\begin{equation}
x_j = x_\text{min} + (j-1) \Delta x
\end{equation}
\sphinxAtStartPar
where
\label{equation:Section4_v2:2f64238c-4a94-415f-9076-9c61d23dc909}\begin{equation}
\Delta x = \frac{x_\text{max} - x_\text{min}}{N-1}.
\end{equation}
\sphinxAtStartPar
Next, we want to set up some basis \(\{|\phi_i\rangle\}\) that allows us to express our wavefunction as a superposition of convenient basis functions. Putting this into math based on last week’s section, we want a way to implement the expansion
\label{equation:Section4_v2:edc52a9b-18e7-430d-87f3-5bd895fd657c}\begin{equation}
\psi(x) = \langle x | \psi \rangle = \sum_{i=1}^{n} c_i \langle x | \phi_i \rangle = \sum_{i=1}^{n} c_i \phi_i(x).
\end{equation}
\sphinxAtStartPar
There are many possible reasonable choices of this basis, and there is a vast literature of DVR methods that use different choices (some that can’t even be written as nice analytical functions!). But let’s think about what we would want in a general DVR basis set.

\sphinxAtStartPar
\sphinxstylestrong{Question: What nice properties might we want?}

\sphinxAtStartPar
\sphinxstylestrong{Answer:} Some example of useful properties would be:
\begin{itemize}
\item {} 
\sphinxAtStartPar
We want the basis to satisfy \(\langle x_i | x_j \rangle \propto \delta_{i,j}\)

\item {} 
\sphinxAtStartPar
It would be nice if the basis functions were “well behaved” so that we can evaluate derivatives, Fourier transforms, etc.

\end{itemize}

\sphinxAtStartPar
One example of a set of functions that satisfy these desiderata are the \sphinxstyleemphasis{sinc functions}:
\label{equation:Section4_v2:db8077b3-8860-453e-8f89-13fa2dbc7c21}\begin{equation}
\phi_j(x) = \frac{1}{\sqrt{\Delta x}} \frac{\sin[\pi (x-x_j)/\Delta x]}{\pi (x-x_j)/\Delta x} = \frac{1}{\sqrt{\Delta x}} \text{sinc} [\pi (x-x_j)/\Delta x].
\end{equation}
\sphinxAtStartPar
First of all, let’s explore why these basis functions are useful. It’s best to start this discussion graphically, so let’s use some code to implement the basis and plot the basis functions.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
In the space below, we give you some code that defines a grid of x points and a function that implements the sinc\sphinxhyphen{}basis. Use these pieces of code to explore the sinc\sphinxhyphen{}basis functions and learn about their properties. You are looking to answer questions like the following:
\begin{itemize}
\item {} 
\sphinxAtStartPar
What is the value of a basis function \(\phi_j\) at grid point \(x_j\)?

\item {} 
\sphinxAtStartPar
What is the value of a basis function \(\phi_j\) at a grid point \(x_{j+1}\)? At \(x_{j+2}\)?

\item {} 
\sphinxAtStartPar
In general, how do the basis functions relate to one another?

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Parameters that we set}
\PYG{n}{xmin} \PYG{o}{=} \PYG{l+m+mi}{0}
\PYG{n}{xmax} \PYG{o}{=} \PYG{l+m+mi}{9}
\PYG{n}{N} \PYG{o}{=} \PYG{l+m+mi}{10}

\PYG{c+c1}{\PYGZsh{} Grid spacing and position\PYGZhy{}space grid points}
\PYG{n}{Delta\PYGZus{}x} \PYG{o}{=} \PYG{p}{(}\PYG{n}{xmax}\PYG{o}{\PYGZhy{}}\PYG{n}{xmin}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{N}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{xs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{n}{xmin}\PYG{p}{,}\PYG{n}{xmax}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}
\PYG{n}{xs\PYGZus{}fine} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{n}{xmin}\PYG{p}{,}\PYG{n}{xmax}\PYG{p}{,}\PYG{n}{Delta\PYGZus{}x}\PYG{o}{/}\PYG{l+m+mi}{1000}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Definition of the sinc\PYGZhy{}basis functions}
\PYG{k}{def} \PYG{n+nf}{phi}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{xj}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{Delta\PYGZus{}x}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sinc}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{xj}\PYG{p}{)}\PYG{o}{/}\PYG{n}{Delta\PYGZus{}x}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
There are two useful ways that we can look at these basis functions. First of all, we can plot an example like \(\phi_3(x_j)\) to look at the \(i=3\) basis function evaluated at each grid point. If we overlay this with a plot of \(\phi_3(x)\) evaluated on a much finer grid, we see that the sinc\sphinxhyphen{}basis is defined such that a given basis function \(\phi_i\) is nonzero at grid point \(x_i\), and its oscillations ensure that it passes through zero at every other grid point!

\sphinxAtStartPar
\sphinxstylestrong{Question:} Does it matter that the sinc function takes on nonzero values away from the \(i\neq j\) grid points?

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Section4_v2_12_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
It can also be useful to look at a series of these sinc functions centered at different grid points. Notice where they all pass through zero, and where each individual basis function doesn’t pass through zero.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Section4_v2_14_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}

\subsection{Interpreting the Sinc\sphinxhyphen{}Basis}
\label{\detokenize{Section4_v2:interpreting-the-sinc-basis}}
\sphinxAtStartPar
\sphinxstylestrong{Question:} In light of these plots, how can we interpret the sinc\sphinxhyphen{}basis functions as compared to a set of Dirac delta functions?

\sphinxAtStartPar
\sphinxstylestrong{Answer:} This is a finite resolution basis that is like the closest possible approximation to a delta function that we can make for a given range on the number of momentum basis functions that our spatial grid can accomodate. As the plots above show, we means this in the sense that these basis states satisfy
\label{equation:Section4_v2:e2034f23-a7c7-41a7-88e3-9c47de4b9463}\begin{equation}
\phi_j(x_k) \propto \delta_{k,j},
\end{equation}
\sphinxAtStartPar
so a given basis function only gives a nonzero contribution to a function at the point at which that basis function is centered.

\sphinxAtStartPar
The sinc basis has a nice relationship to the Fourier transforms that we discussed last week. In particular, the sinc basis functions can be written as follows:
\label{equation:Section4_v2:d3dacc37-bf49-4940-b87e-4f874a515e74}\begin{equation}
\phi_j(x) = \frac{\sqrt{\Delta x}}{2\pi} \int_{-\pi/\Delta x}^{\pi/\Delta x} e^{i k(x-x_j)} dk
\end{equation}
\sphinxAtStartPar
\sphinxstylestrong{Question:} Can you justify this form qualitatively? How does it relate to Fourier transforms that we studied last week? And why are the limits on the integral those numbers?


\section{Deriving the Kinetic Energy Matrix}
\label{\detokenize{Section4_v2:deriving-the-kinetic-energy-matrix}}
\sphinxAtStartPar
Now that we have a useful basis, we can try to solve problems with it. We still need to learn how to express the Hamiltonian in this basis. Since the Hamiltonian is
\label{equation:Section4_v2:641be3c5-a365-47e4-a699-7b6c5e768aca}\begin{equation}
H = -\frac{\hbar^2}{2m} \frac{d^2}{dx^2} + V(x)
\end{equation}
\sphinxAtStartPar
we need to figure out how to express the second derivative operator and the \(V(x)\) operator in our chosen basis.

\sphinxAtStartPar
Let’s start with the kinetic energy term. We want to derive a kinetic energy matrix with matrix elements
\label{equation:Section4_v2:3a4eeba7-b034-4004-b48d-d011de2f4d9e}\begin{equation}
T_{ij} = -\frac{\hbar^2}{2m} \left \langle \phi_i \left\lvert \frac{d^2}{dx^2} \right\rvert \phi_j \right \rangle.
\end{equation}
\sphinxAtStartPar
It turns out this is where the Fourier transform expression is super helpful. We can go through the following steps:
\label{equation:Section4_v2:28141e62-2974-47b8-89a5-730efded2525}\begin{equation}
\int_{-\infty}^{\infty} \phi_i^\ast(x) \frac{d^2}{dx^2} \phi_j(x) dx = \frac{\Delta x}{(2\pi)^2} \int_{-\infty}^{\infty} dx \int_{-\pi/\Delta x}^{\pi/\Delta x} e^{-i k (x-x_i)} dk \int_{-\pi/\Delta x}^{\pi/\Delta x} \left( \frac{d^2}{dx^2} e^{i k' (x-x_j)} \right) dk'
\end{equation}
\sphinxAtStartPar
Because we’ve expressed the basis function in terms of plane waves, evaluating \(\frac{d^2}{dx^2}\) is really easy: it just corresponds to pulling down a factor of \((ik)^2\). That gets us to
\label{equation:Section4_v2:73681b08-08e2-4111-872f-1fa7d73e5675}\begin{equation}
\frac{\Delta x}{(2\pi)^2} \int_{-\pi/\Delta x}^{\pi/\Delta x} (ik)^2 e^{i k (x_i - x_j)} dk.
\end{equation}
\sphinxAtStartPar
If you work through these integrals, you will find that:
\label{equation:Section4_v2:bea09371-086d-4cfd-ab2d-5f918123d19a}\begin{equation}
\boxed{T_{i,j=i} = \frac{\hbar^2}{2m \Delta x^2} \frac{\pi^2}{3}}
\end{equation}
\sphinxAtStartPar
and
\label{equation:Section4_v2:08c4c729-ab4c-40ae-ac95-969aab9e97ab}\begin{equation}
\boxed{T_{i,j \neq i} = \frac{\hbar^2}{2m \Delta x^2} \frac{2 (-1)^{i-j}}{(i-j)^2}}
\end{equation}
\sphinxAtStartPar
\sphinxstylestrong{Task:} Now fill in the code below to make a function that builds the kinetic energy operator and the potential energy operator.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} work in some convenient units}
\PYG{n}{hbar} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{m} \PYG{o}{=} \PYG{l+m+mi}{1}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Function to make the kinetic energy operator}
\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}T}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{Delta\PYGZus{}x} \PYG{o}{=} \PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{N} \PYG{o}{=} \PYG{n}{xs}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{Tmat} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{n}{N}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{p}{)}
    
    \PYG{c+c1}{\PYGZsh{} now loop over kinetic energy matrix and fill in matrix elements}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{N}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{N}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{if} \PYG{n}{i}\PYG{o}{==}\PYG{n}{j}\PYG{p}{:}
                \PYG{n}{Tmat}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{n}{j}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{n}{hbar}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{m}\PYG{o}{*}\PYG{n}{Delta\PYGZus{}x}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{n}{j}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{3}
            \PYG{k}{else}\PYG{p}{:}
                \PYG{n}{Tmat}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{n}{j}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{n}{hbar}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{m}\PYG{o}{*}\PYG{n}{Delta\PYGZus{}x}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{n}{j}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mi}{2}\PYG{o}{/}\PYG{p}{(}\PYG{n}{i}\PYG{o}{\PYGZhy{}}\PYG{n}{j}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
                
    \PYG{k}{return} \PYG{n}{Tmat}
  
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Deriving the Potential Energy Matrix}
\label{\detokenize{Section4_v2:deriving-the-potential-energy-matrix}}
\sphinxAtStartPar
For the potential energy matrix, we need to express \(V(x)\) in matrix form. Since \(V(x)\) can be expanded as a power series in the position operator \(\hat{x}\), let’s first look at the matrix form of \(\hat{x}\) itself. We want the matrix elements \(x_{ij} = \langle \phi_i | x | \phi_j \rangle\). In other words, we want
\label{equation:Section4_v2:458d7eca-ae02-41a4-8133-94af0605d3fa}\begin{equation}
\int_{-\infty}^{\infty} \phi_i(x)^\ast x \phi_j(x) dx = \frac{\Delta x}{(2\pi)^2} \int_{-\pi/\Delta x}^{\pi/\Delta x} dk \int_{-\pi/\Delta x}^{\pi/\Delta x} dk' e^{ikx_i - ik'x_j} \int_{-\infty}^{\infty} x e^{i x (k'-k)} dx.
\end{equation}
\sphinxAtStartPar
In the last term, note that we can replace \(x\) by \(\frac{d}{d(ik')}\) and then pull the derivative outside of the integral over \(x\) (since it doesn’t depend on \(x\) anymore).  Working through the integrals after that step, we get to
\label{equation:Section4_v2:21828791-ac00-4992-967e-d21039c15cfe}\begin{equation}
x_{ij} = \frac{\Delta x}{2\pi} x_i \int_{-\pi/\Delta x}{\pi/\Delta x} dk' e^{ik'(x_i-x_j)} = x_i \delta_{i,j}.
\end{equation}
\sphinxAtStartPar
\sphinxstylestrong{The important conclusion is that \(\hat{x}\) is diagonal in this basis!} So the potential energy, which can be expanded in powers of \(x\) is also diagonal in this basis! Knowing this, we can just make the potential energy operator by building a diagonal matrix from \(V(x)\). The function \sphinxcode{\sphinxupquote{make\_V}} does this, and then the function \sphinxcode{\sphinxupquote{make\_H}} just calls the kinetic and potential energy functions and puts them together.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Function to make the potential energy operator}
\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}V}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{Vfunc}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{Vmat} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{diag}\PYG{p}{(}\PYG{n}{Vfunc}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{Vmat}

\PYG{c+c1}{\PYGZsh{} Function to make the full Hamiltonian}
\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}H}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{Vfunc}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{n}{make\PYGZus{}T}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o}{+} \PYG{n}{make\PYGZus{}V}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{Vfunc}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\section{Testing the DVR code}
\label{\detokenize{Section4_v2:testing-the-dvr-code}}
\sphinxAtStartPar
That was a lot of work to get our Hamiltonian matrix. But now let’s see the payoff! We’ll see that the DVR code is incredibly accurate, especially compared to the finite differences method that we used before. As always let’s test our code by using a harmonic oscillator potential. Let’s start with a 20 point grid and see how the calculations do for energies and wavefunctions.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{xs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{Vharmonic}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{l+m+mf}{0.5}\PYG{o}{*}\PYG{n}{x}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Ham} \PYG{o}{=} \PYG{n}{make\PYGZus{}H}\PYG{p}{(}\PYG{n}{xs}\PYG{p}{,}\PYG{n}{Vharmonic}\PYG{p}{)}
\PYG{n}{vals}\PYG{p}{,} \PYG{n}{vecs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{eigh}\PYG{p}{(}\PYG{n}{Ham}\PYG{p}{)}
\PYG{n}{vals}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{4}\PYG{p}{]}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
array([0.50042652, 1.49199271, 2.54377448, 3.30864454])
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{xs}\PYG{p}{,}\PYG{n}{vecs}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{:}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
[\PYGZlt{}matplotlib.lines.Line2D at 0x7fe8590c5e50\PYGZgt{},
 \PYGZlt{}matplotlib.lines.Line2D at 0x7fe8590c5340\PYGZgt{},
 \PYGZlt{}matplotlib.lines.Line2D at 0x7fe8590c5fa0\PYGZgt{}]
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Section4_v2_35_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
Let’s look at the accuracy of our solutions as a function of quantum number.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Text(0, 0.5, \PYGZsq{}Fractional error\PYGZsq{})
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Section4_v2_37_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Question:} Explain the differences between the case with 50 grid points and the case with 60 grid points. Why is the agreement better to higher \(n\) for 60 grid points? Also, why does the agreement seem to always get worse above \(n \sim 25\), even if the number of grid points is increased?


\subsection{Comparing DVR to Finite Differences}
\label{\detokenize{Section4_v2:comparing-dvr-to-finite-differences}}
\sphinxAtStartPar
Let’s look at the accuracy of the numerical solution as a function of the number of grid points. We can compare this to the results of HW 1 to see how the DVR method does against finite differences.

\sphinxAtStartPar
In this block, write a function that computes the fractional error in the SHO eigenstates as a function of the number of grid points used.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}
\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
This next block is already written for you– nothing you need to do!— to implement and solve the same problem using the Numerov method. The code is taken from the HW1 solutions.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}
\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Now, make a plot of the relative errors comparing the numerov and DVR methods for the ground state as a function of the grid spacing \(\Delta x\).

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Text(0, 0.5, \PYGZsq{}Fractional error\PYGZsq{})
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Section4_v2_46_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Clearly the DVR method is much better than the Numerov technique! For reasonable grid sizes, the DVR method gets the ground\sphinxhyphen{}state energy with almost 10 orders of magnitude better relative agreement!! (And remember, the Numerov method was already much better than a “plain” second\sphinxhyphen{}order finite differences approximation to the Hamiltonian…)

\sphinxAtStartPar
\sphinxstylestrong{Question:} Why do you think the DVR method stops getting more accurate at a certain step size? What does this tell you about setting up simulations?


\chapter{Section 6: An Intuitive Picture of Band Structure}
\label{\detokenize{Section6_v2:section-6-an-intuitive-picture-of-band-structure}}\label{\detokenize{Section6_v2::doc}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{from} \PYG{n+nn}{ipywidgets} \PYG{k+kn}{import} \PYG{n}{interact}\PYG{p}{,} \PYG{n}{FloatSlider}
\PYG{k+kn}{from} \PYG{n+nn}{IPython}\PYG{n+nn}{.}\PYG{n+nn}{display} \PYG{k+kn}{import} \PYG{n}{display}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
In this Section, we are going to explore the emergence of band structure using simple models that you have studied before. We will consider a series of potential barriers (equally spaced) to simulate the periodic potential that electrons experience inside a crystal. By varying the heights of these barriers, we can smoothly transition between two simple limits: (1) a single, wide square well and (2) a series of narrow, uncoupled square wells. Band structure emerges between these two extremes.

\sphinxAtStartPar
\sphinxstylestrong{Learning Goals}
After this Section, you should:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Be able to explain the qualitative origins of energy bands

\item {} 
\sphinxAtStartPar
Explain the origin of energy spacings \sphinxstyleemphasis{within} bands as compared to \sphinxstyleemphasis{between} bands

\item {} 
\sphinxAtStartPar
Describe the shape of electronic wavefunctions at the edge of each Brillouin zone

\item {} 
\sphinxAtStartPar
Explain the connection between bound state and scattering methods of characterizing the energy levels of the periodic potential

\end{itemize}


\section{Qualitative Solution}
\label{\detokenize{Section6_v2:qualitative-solution}}
\sphinxAtStartPar
Before we dive into numerical solutions, let’s think about the following qualitative situation: we have a square well of width \(L\). Within the well, we place a series of barriers that partition the square well into \(N\) narrower wells with width \(a\). Each barrier has height \(\beta\) and thickness \(b\).

\sphinxAtStartPar
Let’s start by considering the barriers to be infinitely thin (basically, delta functions). Now, as a class, let’s work through the following questions:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
What are the energies and eigenstates of the wide well if the barriers are not present (\(\beta=0\))?

\item {} 
\sphinxAtStartPar
When \(\beta \rightarrow \infty\), what should the wavefunctions look like?

\item {} 
\sphinxAtStartPar
As we increase \(\beta\) to take on finite values, what will happen to the wavefunctions? How will they look? What will their ordering be like relative to the cases we just described?

\item {} 
\sphinxAtStartPar
What analogies could we make between excitation of different bands and excitations of atoms in a solid?

\end{enumerate}

\sphinxAtStartPar
After going through these qualitative arguments, we can now look at what the numerics tell us.


\section{Building the potential V(x)}
\label{\detokenize{Section6_v2:building-the-potential-v-x}}
\sphinxAtStartPar
First we’ll write some functions that build our model potential. Our model includes the following parameters:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(L\): width of the enclosing square well

\item {} 
\sphinxAtStartPar
\(a\): width of each narrow square well

\item {} 
\sphinxAtStartPar
\(b\): thickness of each internal barrier

\item {} 
\sphinxAtStartPar
\(N\): number of narrow square wells

\item {} 
\sphinxAtStartPar
\(\beta\): heigh of each barrier

\end{itemize}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} This function will return another function that depends only on x.}
\PYG{c+c1}{\PYGZsh{} That\PYGZsq{}s a convenient way to get a function of x that can go into our DVR code.}
\PYG{c+c1}{\PYGZsh{} fullwidth allows us to embed the entire potential in a wider \PYGZdq{}framing\PYGZdq{} square well}
\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}potential}\PYG{p}{(}\PYG{n}{N}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{,} \PYG{n}{beta}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{L} \PYG{o}{=} \PYG{n}{N}\PYG{o}{*}\PYG{n}{a}\PYG{o}{+}\PYG{p}{(}\PYG{n}{N}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{n}{b}
    \PYG{k}{if} \PYG{n}{N} \PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{0}\PYG{p}{:}
        \PYG{n}{x0s} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{N}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{a}\PYG{o}{+}\PYG{n}{b}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{b}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{L}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{c+c1}{\PYGZsh{} locations of barrier centers}
        \PYG{k}{def} \PYG{n+nf}{fn}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{:}
            \PYG{c+c1}{\PYGZsh{} builds a barrier of height beta and width b centered at each x0 value:}
            \PYG{n}{barriers} \PYG{o}{=} \PYG{n}{beta}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{heaviside}\PYG{p}{(}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{x0s}\PYG{p}{[}\PYG{n}{n}\PYG{p}{]}\PYG{o}{+}\PYG{n}{b}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{heaviside}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x}\PYG{o}{\PYGZhy{}}\PYG{n}{x0s}\PYG{p}{[}\PYG{n}{n}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{n}{b}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{)} \PYG{k}{for} \PYG{n}{n} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{N}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,} \PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{barriers} \PYG{o}{+} \PYG{n}{beta} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{x} \PYG{o}{\PYGZlt{}} \PYG{o}{\PYGZhy{}}\PYG{n}{L}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{\PYGZhy{}}\PYG{n}{b}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{|} \PYG{p}{(}\PYG{n}{x}\PYG{o}{\PYGZgt{}}\PYG{n}{L}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{+}\PYG{n}{b}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{n}{a} \PYG{o}{=} \PYG{n}{L}
        \PYG{k}{def} \PYG{n+nf}{fn}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{return} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{beta} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{x} \PYG{o}{\PYGZlt{}} \PYG{o}{\PYGZhy{}}\PYG{n}{L}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{|} \PYG{p}{(}\PYG{n}{x}\PYG{o}{\PYGZgt{}}\PYG{n}{L}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
    
    \PYG{k}{return} \PYG{n}{fn}
    
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{f\PYGZus{}test} \PYG{o}{=} \PYG{n}{make\PYGZus{}potential}\PYG{p}{(}\PYG{l+m+mi}{9}\PYG{p}{,} \PYG{l+m+mf}{1.1e\PYGZhy{}9}\PYG{p}{,} \PYG{l+m+mf}{0.1e\PYGZhy{}9}\PYG{p}{,} \PYG{l+m+mf}{1.5}\PYG{p}{)}
\PYG{n}{x} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{5000}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}9}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{f\PYGZus{}test}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{x}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{V}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Text(0, 0.5, \PYGZsq{}V\PYGZsq{})
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Section6_v2_10_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Making the DVR code}
\label{\detokenize{Section6_v2:making-the-dvr-code}}
\sphinxAtStartPar
Next, we set up the DVR code from Section 4 to build the Hamiltonian for our system. This code is the same as we have used previously.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}
\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Let’s test this on a potential consisting of 12 wells that are fairly deep. After building the potential, we construct the Hamiltonian, evaluate the eigenvectors/eigenvalues, and then plot.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Section6_v2_15_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
We can now plot the numerically computed eigenvalues. Let’s overlay these values with the energy levels that would occur if there were no barriers inside the potential—the energy levels of the “wide” finite square well.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}
\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
[\PYGZlt{}matplotlib.lines.Line2D at 0x7fb5d3d27790\PYGZgt{}]
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Section6_v2_18_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
Notice that the periodic potential leads to a structure highly reminiscient of band structure: the energy levels roughly follow the parabolic shape expected from the wide square well (or, from a different perspective, for the free particle), but the levels are broken up into bands with the characteristic shape that we see in class. And there are band gaps between these bands.

\sphinxAtStartPar
\sphinxstylestrong{Question: What will the plot look like if we increase the well separation to the point that the wells are essentially fully uncoupled? Will there be energy degeneracies? How many levels will share the same energy? What happens as the number of wells is increased–which energy gaps “close” and which remain?}

\sphinxAtStartPar
To answer these questions, perform a “numerical experiment” and compare your results to the appropriate square well. How do the numbers compare?

\sphinxAtStartPar
\sphinxstylestrong{Question: What happens if the well separation is decreased to essentially zero? How do these energies compare to the appropriate finite square well? What about the comparison to free particle energies?}

\sphinxAtStartPar
Let’s look at the wavefunctions to understand this even better. It will be useful to plot the actual wavefunctions and have some interactivity. The code below makes a plot with a slider that allows you to look at all of the bound eigenstates for a given potential. Once you set the number of wells, their width, and their barriers, you can scan through the eigenstates and look at the behavior.

\begin{sphinxuseclass}{cell}
\begin{sphinxuseclass}{tag_hide-input}
\end{sphinxuseclass}
\end{sphinxuseclass}
\sphinxAtStartPar
For example, we can start with 12 wells that are each 0.8 nm wide, 4 eV high, and have a 0.05 nm barrier between them. For this set of parameters, use the interactive plotting to gain some insights about the potential.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N} \PYG{o}{=} \PYG{l+m+mi}{12} \PYG{c+c1}{\PYGZsh{} number of wells}
\PYG{n}{a} \PYG{o}{=} \PYG{l+m+mf}{0.8e\PYGZhy{}9}
\PYG{n}{b} \PYG{o}{=} \PYG{l+m+mf}{0.05e\PYGZhy{}9} \PYG{c+c1}{\PYGZsh{} wall thickness in nm}
\PYG{n}{beta} \PYG{o}{=} \PYG{l+m+mi}{4} \PYG{o}{/} \PYG{l+m+mf}{6.24150907e18} \PYG{c+c1}{\PYGZsh{} well height in J}
\PYG{n}{V\PYGZus{}wells} \PYG{o}{=} \PYG{n}{make\PYGZus{}potential}\PYG{p}{(}\PYG{n}{N}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{,} \PYG{n}{beta}\PYG{p}{)}
\PYG{n}{xs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{900}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}9}

\PYG{n}{Ham}\PYG{o}{=}\PYG{n}{make\PYGZus{}H}\PYG{p}{(}\PYG{n}{xs}\PYG{p}{,}\PYG{n}{V\PYGZus{}wells}\PYG{p}{)}

\PYG{n}{vals}\PYG{p}{,} \PYG{n}{vecs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{eigh}\PYG{p}{(}\PYG{n}{Ham}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} make sure ground state is upward going}
\PYG{n}{vecs}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{vecs}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sign}\PYG{p}{(}\PYG{n}{vecs}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{argmax}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{vecs}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} number of bound states:}
\PYG{n}{nbound} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{p}{[}\PYG{n}{vals}\PYG{o}{\PYGZlt{}}\PYG{n}{beta}\PYG{p}{]}\PYG{p}{)}


\PYG{n}{interact\PYGZus{}wavefunction}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
interactive(children=(FloatSlider(value=0.0, description=\PYGZsq{}Eigenstate\PYGZsq{}, max=32.0, step=1.0), Output()), \PYGZus{}dom\PYGZus{}cl…
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Question: Using the interactive graphs above, how does the behavior of each wavefunction within a single band conform to our expectations from Bloch’s theorem? How do the wavefunctions differ from band to band? What do you expect to happen as \(N \rightarrow \infty\)?}


\section{Transfer matrix approach}
\label{\detokenize{Section6_v2:transfer-matrix-approach}}
\sphinxAtStartPar
There’s a totally different way to look at band structure: by studying the scattering properties of the potential. This is a complementary method to learn about a potentials bound states. Scattering studies are widely used in many fields of physics/chemistry, from studying the solid state to studying atoms and molecules. Let’s see what we can learn about electronic band structure from this point of view using the transfer matrix program that you wrote on HW2.

\sphinxAtStartPar
First of all, let’s go over the idea of the transfer matrix approach.

\sphinxAtStartPar
\sphinxstylestrong{Set up approach, talk about different role of propagation vs. transmission matrices.}

\sphinxAtStartPar
The code to implement each of these matrices is copied below.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{DMat}\PYG{p}{(}\PYG{n}{k1}\PYG{p}{,} \PYG{n}{k2}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{res} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{n}{dtype}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{complex\PYGZus{}}\PYG{p}{)}
    \PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{+} \PYG{n}{k2}\PYG{o}{/}\PYG{n}{k1}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}
    \PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{k2}\PYG{o}{/}\PYG{n}{k1}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{2}
    \PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{k}{return} \PYG{n}{res}

\PYG{k}{def} \PYG{n+nf}{PMat}\PYG{p}{(}\PYG{n}{k}\PYG{p}{,} \PYG{n}{L}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{res} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,}\PYG{n}{dtype}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{complex\PYGZus{}}\PYG{p}{)}
    \PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{n}{j} \PYG{o}{*} \PYG{n}{k} \PYG{o}{*} \PYG{n}{L}\PYG{p}{)}
    \PYG{n}{res}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{n}{j} \PYG{o}{*} \PYG{n}{k} \PYG{o}{*} \PYG{n}{L}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{res}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
\sphinxstylestrong{Question: What do the peaks here represent? What is the physics going on when N=2? N=3? Large N?}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{a} \PYG{o}{=} \PYG{l+m+mf}{0.8e\PYGZhy{}9}
\PYG{n}{b} \PYG{o}{=} \PYG{l+m+mf}{0.1e\PYGZhy{}9}

\PYG{n}{Es} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{12.0}\PYG{p}{,} \PYG{l+m+mf}{0.001}\PYG{p}{)} \PYG{o}{/} \PYG{l+m+mf}{6.24150907e18}
\PYG{n}{width\PYGZus{}barrier} \PYG{o}{=} \PYG{n}{b}
\PYG{n}{width\PYGZus{}gap} \PYG{o}{=} \PYG{n}{a}
\PYG{n}{Vb}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{o}{/} \PYG{l+m+mf}{6.24150907e18}

\PYG{n}{Nwells}\PYG{o}{=}\PYG{l+m+mi}{30}


\PYG{n}{Ttrans} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{Es}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}
\PYG{n}{i} \PYG{o}{=} \PYG{l+m+mi}{0}
\PYG{k}{for} \PYG{n}{E} \PYG{o+ow}{in} \PYG{n}{Es}\PYG{p}{:}
    \PYG{n}{klow} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{emath}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{m} \PYG{o}{*} \PYG{n}{E}\PYG{o}{/}\PYG{n}{hbar}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{khigh} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{emath}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{m} \PYG{o}{*} \PYG{p}{(}\PYG{n}{E} \PYG{o}{\PYGZhy{}} \PYG{n}{Vb}\PYG{p}{)}\PYG{o}{/}\PYG{n}{hbar}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{res\PYGZus{}mat} \PYG{o}{=} \PYG{n}{DMat}\PYG{p}{(}\PYG{n}{klow}\PYG{p}{,} \PYG{n}{khigh}\PYG{p}{)} \PYG{o}{@} \PYG{n}{PMat}\PYG{p}{(}\PYG{n}{khigh}\PYG{p}{,} \PYG{n}{width\PYGZus{}barrier}\PYG{p}{)} \PYG{o}{@} \PYG{n}{DMat}\PYG{p}{(}\PYG{n}{khigh}\PYG{p}{,} \PYG{n}{klow}\PYG{p}{)} \PYG{o}{@} \PYG{n}{PMat}\PYG{p}{(}\PYG{n}{klow}\PYG{p}{,} \PYG{n}{width\PYGZus{}gap}\PYG{p}{)}
    \PYG{n}{U}\PYG{p}{,} \PYG{n}{V} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{eig}\PYG{p}{(}\PYG{n}{res\PYGZus{}mat}\PYG{p}{)}
    \PYG{n}{diag\PYGZus{}res\PYGZus{}mat} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{diag}\PYG{p}{(}\PYG{p}{[}\PYG{n}{U}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}\PYG{n}{U}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{res\PYGZus{}mat} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{matrix\PYGZus{}power}\PYG{p}{(}\PYG{n}{diag\PYGZus{}res\PYGZus{}mat}\PYG{p}{,}\PYG{n}{Nwells}\PYG{p}{)}
    \PYG{n}{res\PYGZus{}mat} \PYG{o}{=} \PYG{n}{V} \PYG{o}{@} \PYG{n}{res\PYGZus{}mat} \PYG{o}{@} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{inv}\PYG{p}{(}\PYG{n}{V}\PYG{p}{)}
    \PYG{n}{Ttrans}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{res\PYGZus{}mat}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{/} \PYG{n}{np}\PYG{o}{.}\PYG{n}{abs}\PYG{p}{(}\PYG{n}{res\PYGZus{}mat}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
    \PYG{n}{i} \PYG{o}{=} \PYG{n}{i} \PYG{o}{+} \PYG{l+m+mi}{1}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Es} \PYG{o}{*} \PYG{l+m+mf}{6.24150907e18}\PYG{p}{,} \PYG{n}{Ttrans}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Energy (eV)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Transmission}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{both}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{which}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{major}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\noindent\sphinxincludegraphics{{Section6_v2_31_0}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}
\sphinxAtStartPar
Let’s compare the transmission peaks to the bound state energy of our finite square well.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{V\PYGZus{}wells} \PYG{o}{=} \PYG{n}{make\PYGZus{}potential}\PYG{p}{(}\PYG{n}{Nwells}\PYG{p}{,} \PYG{n}{a}\PYG{p}{,} \PYG{n}{b}\PYG{p}{,} \PYG{n}{Vb}\PYG{p}{)}
\PYG{n}{xs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+m+mi}{1500}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mf}{1e\PYGZhy{}9}

\PYG{n}{Ham}\PYG{o}{=}\PYG{n}{make\PYGZus{}H}\PYG{p}{(}\PYG{n}{xs}\PYG{p}{,}\PYG{n}{V\PYGZus{}wells}\PYG{p}{)}

\PYG{n}{vals}\PYG{p}{,} \PYG{n}{vecs} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{eigh}\PYG{p}{(}\PYG{n}{Ham}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}
\sphinxAtStartPar
Now let’s compare the transmission fraction to the band energies.

\sphinxAtStartPar
\sphinxstylestrong{Question: How can we easily determine the limits of each energy band? (How does it compare to the number of wells being simulated?}

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{band\PYGZus{}limits} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{k}{for} \PYG{n}{n} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{band\PYGZus{}limits}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{n}\PYG{o}{*}\PYG{n}{Nwells}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{band\PYGZus{}limits}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{n}\PYG{o}{*}\PYG{n}{Nwells}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Es} \PYG{o}{*} \PYG{l+m+mf}{6.24150907e18}\PYG{p}{,} \PYG{n}{Ttrans}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{limegreen}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{p}{[}\PYG{n}{plt}\PYG{o}{.}\PYG{n}{axvline}\PYG{p}{(}\PYG{n}{vals}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{*}\PYG{l+m+mf}{6.24150907e18}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{black}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n}{band\PYGZus{}limits}\PYG{p}{]}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Energy (eV)}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Transmission}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{tick\PYGZus{}params}\PYG{p}{(}\PYG{n}{axis}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{both}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{which}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{major}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{labelsize}\PYG{o}{=}\PYG{l+m+mi}{16}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlim}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
(0.0, 10.0)
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics{{Section6_v2_35_1}.png}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}






\renewcommand{\indexname}{Index}
\printindex
\end{document}